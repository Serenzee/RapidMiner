
# Telegram Quiz Bot System

## Описание

Комплекс из двух Telegram-ботов для автоматизированного тестирования студентов и последующего сбора и экспорта результатов в Excel-таблицу.  
В системе реализована регистрация по ФИО и номеру группы, автоматическая генерация и сортировка результатов по группам, защита от дублирования пользователей и продуманная логика прохождения тестов.

- **Bot.py** — основной Telegram-бот для студентов: регистрация, тестирование, автоматическое сохранение результатов.
- **results_bot.py** — отдельный вспомогательный бот для преподавателя, позволяет скачать итоговую таблицу результатов всех студентов в Excel-формате. Запускается автоматически со стартом основой программы.
- Вся логика, вопросы и структура базы данных реализованы так, чтобы обеспечивать уникальную регистрацию, корректное формирование таблицы и простоту масштабирования системы.

> **Исходный код, все файлы для работы и инструкция по запуску находятся в папке [`Telegram_Bot`](./Telegram_Bot).**  
> Для деплоя или тестирования системы требуется только содержимое этой папки.


## Ссылки на Telegram-ботов
[@ControlQuestionsBot](https://t.me/ControlQuestionsBot) - основной Telegram-бот для тестирования студентов.

[@results_rapidminer_bot](https://t.me/results_rapidminer_bot) - вспомогательный Telegram-бот для преподавателя.

---

## Структура папки Telegram_Bot внутри репозитория

```

Telegram Bot/
│
├── Bot.py               # Основной Telegram-бот для студентов
├── results\_bot.py       # Telegram-бот для преподавателя (выдача Excel-таблицы)
├── requirements.txt     # Список Python-зависимостей для работы обоих ботов
│
├── questions\_pr1.py     # Вопросы для теста 1
├── questions\_pr2.py     # Вопросы для теста 2
├── ...                  # Вопросы для других тестов
├── questions\_pr14.py    # Вопросы для теста 14
│
├── users.db             # (Автоматически создаётся) База пользователей и прогресса
└── results.xlsx         # (Автоматически создаётся) Итоговая Excel-таблица по группам

````

---

## Что автоматически создаётся при запуске

- **users.db** — база данных пользователей, прогресса и результатов.
- **results.xlsx** — итоговая Excel-таблица, автоматически формируется и обновляется после каждой регистрации или завершения теста.

---

## Установка и запуск

### 1. Клонируйте репозиторий

```bash
git clone https://github.com/Serenzee/RapidMiner.git
cd RapidMiner/Telegram_Bot
````

### 2. Установите зависимости

```bash
pip install -r requirements.txt
```

> Python 3.8+ обязателен для работы бота. Проверьте через `python --version`.

### 3. Запуск ботов

#### Локально:

```bash
python Bot.py
```

#### В качестве службы на сервере (Linux):

Создайте unit-файл для systemd (`quizbot.service`):

```
[Unit]
Description=Quiz Telegram Bot
After=network.target

[Service]
ExecStart=/usr/bin/python3 /path/to/Bot.py
WorkingDirectory=/path/to/
Restart=always

[Install]
WantedBy=multi-user.target
```

* Замените `/path/to/Bot.py` и `WorkingDirectory` на свой путь.
* Затем выполните:

  ```bash
  sudo systemctl daemon-reload
  sudo systemctl enable quizbot
  sudo systemctl start quizbot
  ```

---

## Как работает система

* **Регистрация:**
  Каждый студент регистрируется по ФИО (строго три слова с заглавных букв) и номеру группы (одно слово, кириллица/латиница + цифры, верхний регистр).
  Встроена проверка на уникальность ФИО, автоматическая нормализация формата.

* **Прохождение тестов:**
  В меню отображается только один актуальный тест. Доступ к следующим открывается только после завершения текущего. Пройденные тесты не отображаются.
  Каждый тест состоит из 10 случайных вопросов из соответствующего файла вопросов (`questions_prN.py`). В каждом файле 28 вопросов.
  Система блокирует возможность начать заново тест, а также защищает от нажатия неактуальных inline-кнопок.

* **Экспорт результатов:**
  Итоговая Excel-таблица автоматически создаётся и обновляется при каждом действии — результаты сортируются по ФИО, формируются по группам (каждая группа — отдельный лист), колонки имеют автоширину, применяются тонкие границы, выравнивание внутри ячейки по центру.

* **Доступ к результатам:**
  Экспортировать файл `results.xlsx` может только преподаватель через отдельного Telegram-бота (`results_bot.py`).
  В коде заложена возможность ограничения по списку user\_id преподавателей (функция `is_admin`).

---

## Масштабирование и доработка

* Редактирование вопросов / добавление новых / удаление старых реализованы очень просто, достаточно изменить нужный файл с вопросами (`questions_prX.py`).
* Возможна интеграция с другими системами учёта, LMS и т.д. за счёт модульной структуры.
* Весь код снабжён подробными техническими комментариями, легко расширяется и сопровождается.

---

## Безопасность и ограничения

* Доступ к базе и результатам жёстко разделён между студентами и преподавателем.
* При необходимости легко ограничить доступ по user\_id преподавателей (см. функцию `is_admin()` в `results_bot.py`).
* Все чувствительные данные (токены ботов) в публичной версии скрыты — при необходимости запросите их.

---

## Контакты и поддержка

**Автор:**
Кузнецов Савелий Александрович
Telegram: [@Puxtazok](https://t.me/Puxtazok)
E-mail: sakuznetsov_4@miem.hse.ru

**Исходники, инструкции и презентации размещены на GitHub:**
[https://github.com/Serenzee/RapidMiner](https://github.com/Serenzee/RapidMiner)

